<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2013. Axetta LLC. All Rights Reserved.
  -->

<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="ru.axetta.ecafe.processor.core.persistence.regularPaymentSubscription.BankSubscription"
           table="CF_Bank_Subscriptions">
        <id name="idOfSubscription" column="IdOfSubscription" type="long">
            <generator class="identity"/>
        </id>
        <property name="paymentAmount" column="PaymentAmount" type="long" not-null="true"/>
        <property name="thresholdAmount" column="ThresholdAmount" type="long" not-null="true"/>
        <property name="monthsCount" column="MonthsCount" type="integer" not-null="true"/>
        <property name="validToDate" column="ValidToDate" type="ru.axetta.ecafe.processor.core.persistence.DateType"/>
        <property name="activationDate" column="ActivationDate"
                  type="ru.axetta.ecafe.processor.core.persistence.DateType"/>
        <property name="deactivationDate" column="DeactivationDate"
                  type="ru.axetta.ecafe.processor.core.persistence.DateType"/>
        <property name="active" column="IsActive" type="ru.axetta.ecafe.processor.core.persistence.BoolType"
                  not-null="true"/>
        <property name="status" column="Status" type="string"/>
        <property name="paymentId" column="PaymentId" type="string" length="32"/>
        <many-to-one name="client" class="ru.axetta.ecafe.processor.core.persistence.Client" column="IdOfClient"
                     not-null="true" lazy="proxy"/>
        <property name="san" column="San" type="string" length="11"/>
        <property name="paySystem" column="PaySystem" type="integer" not-null="true"/>
        <property name="lastSuccessfulPaymentDate" column="LastSuccessfulPaymentDate"
                  type="ru.axetta.ecafe.processor.core.persistence.DateType"/>
        <property name="lastUnsuccessfulPaymentDate" column="LastUnsuccessfulPaymentDate"
                  type="ru.axetta.ecafe.processor.core.persistence.DateType"/>
        <property name="lastPaymentStatus" column="LastPaymentStatus" type="string"/>
        <property name="unsuccessfulPaymentsCount" column="UnsuccessfulPaymentsCount" type="integer" not-null="true"/>
        <property name="maskedCardNumber" column="MaskedCardNumber" type="string" length="11"/>
        <property name="cardHolder" column="CardHolder" type="string"/>
        <property name="expMonth" column="ExpMonth" type="integer"/>
        <property name="expYear" column="ExpYear" type="integer"/>
        <property name="notificationSent" column="notificationSent"
                  type="ru.axetta.ecafe.processor.core.persistence.BoolType"/>
        <set name="mfrRequests" inverse="true" cascade="save-update" lazy="true">
            <key column="IdOfSubscription"/>
            <one-to-many class="ru.axetta.ecafe.processor.core.persistence.regularPaymentSubscription.MfrRequest"/>
        </set>
        <set name="regularPayments" inverse="true" cascade="save-update" lazy="true">
            <key column="IdOfSubscription"/>
            <one-to-many class="ru.axetta.ecafe.processor.core.persistence.regularPaymentSubscription.RegularPayment"/>
        </set>
    </class>
</hibernate-mapping>