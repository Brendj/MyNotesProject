<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <f:event type="preRenderView" listener="#{facesContext.externalContext.response.setContentType('text/csv;charset=utf-8')}" />
    <f:event type="preRenderView" listener="#{facesContext.externalContext.response.setHeader('Content-disposition', 'attachment;filename=total_services.csv')}" />
<f:view>
    <h:outputText escape="false" value="Организация;Число учащихся;Число льготников;;Зафиксирован проход;;Получили льготное питание;;Получили комплексное питание;;Получили питание в буфете;;Получили питание (льготное + платное)"/>
    <h:outputText escape="false" value="#{mainPage.endOfLine}" />

    <a4j:repeat value="#{totalServicesReportPage.totalReport.items}" var="item">
        <h:outputText escape="false" value="#{item.shortName}" />
        <h:outputText escape="false" value=";#{item.totalClientsCount}" />
        <h:outputText escape="false" value=";#{item.planBenefitClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_planBenefitClientsCount}" />
        <h:outputText escape="false" value=";#{item.currentClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_currentClientsCount}" />
        <h:outputText escape="false" value=";#{item.realBenefitClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_realBenefitClientsCount}" />
        <h:outputText escape="false" value=";#{item.realPaidClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_realPaidClientsCount}" />
        <h:outputText escape="false" value=";#{item.realSnackPaidClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_realSnackPaidClientsCount}" />
        <h:outputText escape="false" value=";#{item.uniqueClientsCount}" />
        <h:outputText escape="false" value=";#{item.per_uniqueClientsCount}" />
        <h:outputText escape="false" value="#{mainPage.endOfLine}" />
    </a4j:repeat>
</f:view>
</ui:composition>