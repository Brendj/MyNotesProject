<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <f:event type="preRenderView" listener="#{facesContext.externalContext.response.setContentType('text/csv;charset=utf-8')}" />
    <f:event type="preRenderView" listener="#{facesContext.externalContext.response.setHeader('Content-disposition', 'attachment;filename=client_org.csv')}" />

    <f:view>
        <h:outputText escape="false"
                      value="Номер учреждения;Название учреждения;Количество учащихся;Количество учащихся (balance больше 0);Количество учащихся (balance равно 0);Количество учащихся (balance меньше 0);Сумма денег;Сумма положительных балансов;Сумма отрицательных балансов"/>
        <h:outputText escape="false" value="#{mainPage.endOfLine}"/>
        <a4j:repeat value="#{mainPage.clientReportPage.clientReport.clientItems}" var="item">
            <h:outputText escape="false"
                          value="#{item.idOfOrg};#{item.officialName};#{item.clientCount};#{item.clientWithPositiveBalanceCount};#{item.clientWithNullBalanceCount};#{item.clientWithNegativeBalanceCount};#{item.balanceSum};#{item.posBalanceSum};#{item.negBalanceSum}"/>
            <h:outputText escape="false" value="#{mainPage.endOfLine}"/>
        </a4j:repeat>
    </f:view>

</ui:composition>